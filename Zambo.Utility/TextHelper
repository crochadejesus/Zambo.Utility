using System;
using System.Collections.Generic;
using System.Globalization;
using System.Web;

namespace Value.Site.Extensions
{
    public static class TextHelper
    {
        private static string noValue = "-";

        public static IHtmlString FormatArea(decimal? assetArea, bool? showUnit)
        {
            var formatedArea = assetArea.GetValueOrDefault().ToString("### ##0");
            formatedArea = formatedArea + (showUnit.GetValueOrDefault() ? "&nbsp;" + LanguageResources.Resources.sqm : "");

            formatedArea = (assetArea.HasValue && assetArea.Value > 0) ? formatedArea : noValue;

            return new HtmlString(formatedArea);
        }

        public static string FormatDate(DateTime? datetime)
        {
            return datetime.HasValue ? datetime.Value.Date.ToString("yyyy-MM-dd") : noValue;
        }

        public static IHtmlString FormatPrice(decimal assetPrice, string assetStatus)
        {
            var formatedPrice = string.Format(CultureInfo.CreateSpecificCulture("pt-PT"), "{0:C0}", assetPrice);
            if (assetStatus == LanguageResources.Resources.SoldLabel || assetStatus == LanguageResources.Resources.ReservedLabel)
            {
                formatedPrice = assetStatus;
            }
            return new HtmlString(formatedPrice);
        }

        public static string FormatPriceReduction(decimal reductionPercentage)
        {
            return "-" + string.Format(CultureInfo.CreateSpecificCulture("pt-PT"), "{0:P1}", reductionPercentage / 100);
        }

        public static string FormatYear(int? year)
        {
            return (year.HasValue && year.Value > 0) ? year.Value.ToString("0000") : noValue;
        }

        /*
        GetCountyArticle
        Need for Search Suggestions
        Solution for different portuguese articles
        Examples:
            Apartamentos <em> Lisboa
            Apartamentos <no> Porto
            Apartamentos <na> Guarda
            Apartamentos <nas> Caldas Da Rainha
        */

        public static string GetCountyArticle(string countyName)
        {
            var inArticle1 = LanguageResources.Resources.SugestedSearchIn;
            var inArticle2 = LanguageResources.Resources.SugestedSearchIn2;
            var inArticle3 = LanguageResources.Resources.SugestedSearchIn3;
            var inArticle4 = LanguageResources.Resources.SugestedSearchIn4;

            //Because there are no logic rules that can be applied to detect
            //witch portuguese articles should be used, all the countries
            //that dont use <em> must belong to the following hardcoded list:
            var mapping = new Dictionary<string, string>();
            //NO
            mapping.Add("Barreiro", inArticle2);
            mapping.Add("Bombarral", inArticle2);
            mapping.Add("Cartaxo", inArticle2);
            mapping.Add("Entroncamento", inArticle2);
            mapping.Add("Funchal", inArticle2);
            mapping.Add("Fundao", inArticle2);
            mapping.Add("Marvao", inArticle2);
            mapping.Add("Montijo", inArticle2);
            mapping.Add("Porto", inArticle2);
            mapping.Add("Sabugal", inArticle2);
            mapping.Add("Satao", inArticle2);
            mapping.Add("Seixal", inArticle2);
            mapping.Add("Tabuaco", inArticle2);
            mapping.Add("Trancoso", inArticle2);
            //NA
            mapping.Add("Batalha", inArticle3);
            mapping.Add("Calheta", inArticle3);
            mapping.Add("Chamusca", inArticle3);
            mapping.Add("Covilha", inArticle3);
            mapping.Add("Estarreja", inArticle3);
            mapping.Add("Figueira Da Foz", inArticle3);
            mapping.Add("Golega", inArticle3);
            mapping.Add("Guarda", inArticle3);
            mapping.Add("Lourinha", inArticle3);
            mapping.Add("Lousa", inArticle3);
            mapping.Add("Lousada", inArticle3);
            mapping.Add("Maia", inArticle3);
            mapping.Add("Marinha Grande", inArticle3);
            mapping.Add("Mealhada", inArticle3);
            mapping.Add("Moita", inArticle3);
            mapping.Add("Murtosa", inArticle3);
            mapping.Add("Nazare", inArticle3);
            mapping.Add("Pampilhosa Da Serra", inArticle3);
            mapping.Add("Povoa De Lanhoso", inArticle3);
            mapping.Add("Povoa De Varzim", inArticle3);
            mapping.Add("Ribeira Grande", inArticle3);
            mapping.Add("Serta", inArticle3);
            //NAS
            mapping.Add("Caldas Da Rainha", inArticle4);
            mapping.Add("Lajes Do Pico", inArticle4);

            return mapping.ContainsKey(countyName) ? mapping[countyName] : inArticle1;
        }
    }
}
